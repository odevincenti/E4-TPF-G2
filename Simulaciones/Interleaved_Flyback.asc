Version 4
SHEET 1 4228 2080
WIRE -864 -288 -864 -320
WIRE 752 -256 592 -256
WIRE 896 -256 752 -256
WIRE 1056 -256 896 -256
WIRE -64 -240 -64 -288
WIRE -64 -240 -208 -240
WIRE 80 -240 -64 -240
WIRE 592 -224 592 -256
WIRE 752 -224 752 -256
WIRE -208 -208 -208 -240
WIRE 80 -208 80 -240
WIRE 896 -192 896 -256
WIRE -864 -176 -864 -208
WIRE 592 -128 592 -160
WIRE 752 -128 752 -160
WIRE -208 -112 -208 -128
WIRE 80 -112 80 -128
WIRE 1056 -112 1056 -256
WIRE 896 -48 896 -112
WIRE 592 -32 592 -48
WIRE 752 -32 752 -48
WIRE -208 0 -208 -32
WIRE 80 0 80 -32
WIRE 592 80 592 48
WIRE 752 80 752 48
WIRE 752 80 592 80
WIRE 896 80 896 16
WIRE 896 80 752 80
WIRE 1056 80 1056 -32
WIRE 1056 80 896 80
WIRE 752 128 592 128
WIRE 896 128 752 128
WIRE 1024 128 896 128
WIRE 1136 128 1024 128
WIRE -16 144 -16 112
WIRE -304 160 -304 112
WIRE 80 160 80 80
WIRE 176 160 80 160
WIRE 224 160 176 160
WIRE 336 160 288 160
WIRE 592 160 592 128
WIRE 752 160 752 128
WIRE -208 192 -208 80
WIRE 80 192 80 160
WIRE 896 192 896 128
WIRE 1024 208 1024 128
WIRE 176 256 176 160
WIRE 224 256 176 256
WIRE 336 256 336 160
WIRE 336 256 304 256
WIRE 592 256 592 224
WIRE 752 256 752 224
WIRE 1136 256 1136 128
WIRE -304 272 -304 240
WIRE -256 272 -304 272
WIRE -16 272 -16 224
WIRE 32 272 -16 272
WIRE -208 336 -208 288
WIRE -64 336 -208 336
WIRE 80 336 80 288
WIRE 80 336 -64 336
WIRE 336 336 336 256
WIRE 896 336 896 272
WIRE 1024 336 1024 272
WIRE -64 368 -64 336
WIRE 592 368 592 336
WIRE 752 368 752 336
WIRE -64 480 -64 448
WIRE 336 480 336 400
WIRE 336 480 -64 480
WIRE 592 480 592 448
WIRE 752 480 752 448
WIRE 752 480 592 480
WIRE 896 480 896 400
WIRE 896 480 752 480
WIRE 1024 480 1024 416
WIRE 1024 480 896 480
WIRE 1136 480 1136 336
WIRE 1136 480 1024 480
WIRE 2256 736 2256 720
WIRE 1584 784 1408 784
WIRE 1728 784 1664 784
WIRE 1920 784 1728 784
WIRE 2256 832 2256 816
WIRE 1728 864 1728 784
WIRE 2256 944 2256 912
WIRE 2416 944 2256 944
WIRE 2256 976 2256 944
WIRE 1488 1008 1488 944
WIRE 1728 1008 1728 944
WIRE 2256 1088 2256 1056
WIRE 304 1328 240 1328
WIRE 928 1328 720 1328
WIRE 304 1392 -48 1392
WIRE 1008 1392 720 1392
WIRE 1088 1392 1008 1392
WIRE 1296 1392 1088 1392
WIRE 1296 1408 1296 1392
WIRE 1088 1424 1088 1392
WIRE 800 1456 720 1456
WIRE 304 1520 240 1520
WIRE 1008 1520 1008 1392
WIRE 1008 1520 720 1520
WIRE 1296 1520 1296 1488
WIRE 1088 1536 1088 1488
WIRE 240 1584 16 1584
WIRE 304 1584 240 1584
WIRE 816 1584 720 1584
WIRE 304 1648 112 1648
WIRE 768 1648 720 1648
WIRE 16 1664 16 1584
WIRE 112 1696 112 1648
WIRE 240 1712 240 1584
WIRE 304 1712 240 1712
WIRE 816 1712 720 1712
WIRE 1552 1744 1456 1744
WIRE 1712 1744 1616 1744
WIRE 304 1776 240 1776
WIRE 896 1776 720 1776
WIRE 240 1808 240 1776
WIRE 16 1824 16 1728
WIRE 112 1824 112 1776
WIRE 1248 1856 1168 1856
WIRE 1360 1856 1360 1776
WIRE 1360 1856 1328 1856
WIRE 1456 1856 1456 1744
WIRE 1456 1856 1360 1856
WIRE 1488 1856 1456 1856
WIRE 1600 1856 1552 1856
WIRE 1712 1856 1712 1744
WIRE 1712 1856 1680 1856
WIRE 1792 1856 1712 1856
WIRE 240 1904 240 1872
FLAG 1056 -256 Vout2
FLAG 1024 128 Vout3
FLAG 1056 80 0
FLAG 1024 480 0
FLAG 80 160 Vds
FLAG 816 1584 0
FLAG 816 1712 0
FLAG 240 1904 0
FLAG 112 1824 0
FLAG 16 1824 0
FLAG 240 1520 Vosc
FLAG 1728 1008 0
FLAG 1920 784 Vo_comp
FLAG 2256 1088 0
FLAG 2416 944 Vref_comp
FLAG 928 1328 Vref
FLAG 2256 720 Vref
FLAG 800 1456 Vcontrol
FLAG -48 1392 Vref_comp
FLAG 1088 1536 0
FLAG 1296 1520 0
FLAG 1408 784 Vout3
FLAG -864 -176 0
FLAG 1792 1856 Comp_out
FLAG 896 1776 Comp_out
FLAG 1168 1856 Vo_comp
FLAG 240 1328 Vinv
FLAG 1360 1776 Vinv
FLAG 1488 1008 0
FLAG -864 -320 Vd
FLAG -304 112 VgA
FLAG -16 112 VgB
FLAG -64 -288 Vd
FLAG -64 480 0
DATAFLAG 128 1392 "round($*10000)/10000"
DATAFLAG 1824 784 "round(V(vo_comp)*10000)/10000"
DATAFLAG 832 1328 "round($*100)/100"
DATAFLAG 1088 1392 ""
DATAFLAG 2336 944 "round($*10000)/10000"
DATAFLAG 816 1776 "round($*10000)/10000"
DATAFLAG 944 -256 "round($*100)/100"
DATAFLAG 944 128 "round($*100)/100"
SYMBOL res -288 256 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName RgA
SYMBOL cap 880 -48 R0
WINDOW 0 32 3 Left 2
SYMATTR InstName C2
SYMBOL res 1040 -128 R0
SYMATTR InstName R2
SYMBOL ind2 -224 -112 M180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L1A
SYMATTR Type ind
SYMBOL ind2 608 -144 M0
SYMATTR InstName L2A
SYMATTR Type ind
SYMBOL cap 880 336 R0
WINDOW 0 32 3 Left 2
SYMATTR InstName C3
SYMBOL ind2 608 240 M0
SYMATTR InstName L3A
SYMATTR Type ind
SYMBOL cap 224 1808 R0
SYMATTR InstName Css
SYMATTR Value 5µ
SYMBOL cap 0 1664 R0
SYMATTR InstName CT
SYMATTR Value 3.3n
SYMBOL res 1680 768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rbo
SYMATTR Value 33k
SYMBOL res 1744 960 R180
WINDOW 0 36 76 Left 2
WINDOW 3 34 44 Left 2
SYMATTR InstName Rao
SYMATTR Value 5.6k
SYMBOL res 2272 832 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3bref
SYMATTR Value 10k
SYMBOL res 2272 1072 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Raref
SYMATTR Value 10k
SYMBOL res 96 1680 R0
SYMATTR InstName RT
SYMATTR Value 2.7k
SYMBOL cap 1072 1424 R0
SYMATTR InstName Cd
SYMATTR Value 100n
SYMBOL voltage 1296 1392 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vgg
SYMATTR Value 16
SYMBOL res -224 -128 R0
SYMATTR InstName rL1A
SYMBOL ind -224 -16 R0
SYMATTR InstName LdA
SYMBOL res 880 176 R0
SYMATTR InstName ESR3
SYMATTR Value 0.2
SYMBOL res 880 -208 R0
SYMATTR InstName ESR2
SYMATTR Value 0.2
SYMBOL res 1008 320 R0
SYMATTR InstName Rled3
SYMBOL voltage -864 -304 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 280
SYMBOL res 576 -48 R0
SYMATTR InstName rL2A
SYMBOL res 576 352 R0
SYMATTR InstName rL3
SYMATTR Value 0.1
SYMBOL LED 1008 208 R0
SYMATTR InstName LED3
SYMBOL cap 320 336 R0
SYMATTR InstName Csn
SYMBOL res 320 240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rsn
SYMBOL res 1120 240 R0
SYMATTR InstName R3
SYMBOL cap 1552 1840 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName Cf1
SYMATTR Value 470n
SYMBOL cap 1616 1728 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName Cf2
SYMATTR Value 1n
SYMBOL res 1696 1840 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rf2
SYMATTR Value 22k
SYMBOL res 1344 1840 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rf1
SYMATTR Value 15k
SYMBOL voltage 1488 848 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 16
SYMBOL res 2272 928 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3brefpot
SYMATTR Value 2.7k
SYMBOL diode 608 -160 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2A
SYMBOL diode 608 224 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3A
SYMBOL nmos -256 192 R0
SYMATTR InstName MA
SYMBOL diode 224 176 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMBOL res 0 240 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName RgB
SYMBOL nmos 32 192 R0
SYMATTR InstName MB
SYMBOL ind2 64 -112 M180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L1B
SYMATTR Type ind
SYMBOL res 64 -128 R0
SYMATTR InstName rL1B
SYMBOL ind 64 -16 R0
SYMATTR InstName LdB
SYMBOL res -80 352 R0
SYMATTR InstName R1
SYMBOL ind2 768 -144 M0
SYMATTR InstName L2B
SYMATTR Type ind
SYMBOL res 736 -48 R0
SYMATTR InstName rL2B
SYMBOL diode 768 -160 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2B
SYMBOL ind2 768 240 M0
SYMATTR InstName L3B
SYMATTR Type ind
SYMBOL res 736 352 R0
SYMATTR InstName rL1
SYMATTR Value 0.1
SYMBOL diode 768 224 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3B
TEXT -288 -264 Left 2 !K1 L1A L2A L3A 1
TEXT 1344 -312 Left 2 ;Directivas Spice
TEXT 1392 -120 Left 2 !.inc opamp.sub
TEXT -408 1664 Left 2 ;fsw= 2/(CT*(RT*0.7))
TEXT -408 1720 Left 2 ;Con CT=3.3nF y RT = 2.8kOhm\n=> fsw = 75KHz
TEXT 912 1640 Left 2 !.inc SG3525A.sub
TEXT -408 1600 Left 2 ;Frecuencia
TEXT 1456 696 Left 2 ;Divisor Vo
TEXT 2192 632 Left 2 ;Divisor Vref
TEXT 1416 1360 Left 2 ;Ponemos una fuente constante solo para simular,porque el modelo spice no contempla la carga inicial de un capacitor entre los 300V y esta parte
TEXT 1392 -264 Left 2 !.param Fs = 75k
TEXT 1392 -232 Left 2 !.param Ts = 1/Fs
TEXT 1392 -200 Left 2 !.param Ton = Ts* D
TEXT 1392 -168 Left 2 !.param D=0.3
TEXT 1392 -88 Left 2 !.tran 0 100m 0 1u
TEXT 1384 1976 Left 2 ;Compensacion de Polos y Ceros
TEXT 0 -264 Left 2 !K1 L1B L2B L3B 1
LINE Normal 1712 1936 1424 1936 2
LINE Normal 1760 1680 1760 1936 2
LINE Normal 1472 1680 1760 1680 2
LINE Normal 1424 1680 1472 1680 2
LINE Normal 1760 1936 1712 1936 2
LINE Normal 1392 1680 1424 1680 2
LINE Normal 1392 1936 1392 1680 2
LINE Normal 1424 1936 1392 1936 2
RECTANGLE Normal 1264 576 -752 -368 2
RECTANGLE Normal 1888 -48 1312 -352 2
RECTANGLE Normal 208 1872 -448 1552 2
