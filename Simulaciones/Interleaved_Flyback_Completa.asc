Version 4
SHEET 1 4228 2080
WIRE -96 -256 -96 -304
WIRE -96 -256 -288 -256
WIRE 96 -256 -96 -256
WIRE 752 -256 592 -256
WIRE 896 -256 752 -256
WIRE 1056 -256 896 -256
WIRE 592 -224 592 -256
WIRE 752 -224 752 -256
WIRE -288 -208 -288 -256
WIRE 96 -208 96 -256
WIRE 896 -192 896 -256
WIRE 1680 -144 1584 -144
WIRE 1760 -144 1680 -144
WIRE 592 -128 592 -160
WIRE 752 -128 752 -160
WIRE -288 -112 -288 -128
WIRE 96 -112 96 -128
WIRE 1056 -112 1056 -256
WIRE 1584 -112 1584 -144
WIRE -800 -96 -800 -128
WIRE 1760 -64 1760 -144
WIRE 896 -48 896 -112
WIRE 592 -32 592 -48
WIRE 752 -32 752 -48
WIRE -288 -16 -288 -32
WIRE 96 -16 96 -32
WIRE 1584 -16 1584 -48
WIRE 1680 -16 1584 -16
WIRE 1696 -16 1680 -16
WIRE 1584 0 1584 -16
WIRE -800 16 -800 -16
WIRE 1680 32 1680 -16
WIRE 1760 64 1760 32
WIRE 1792 64 1760 64
WIRE 1888 64 1792 64
WIRE 1936 64 1888 64
WIRE 592 80 592 48
WIRE 752 80 752 48
WIRE 752 80 592 80
WIRE 896 80 896 16
WIRE 896 80 752 80
WIRE 1056 80 1056 -32
WIRE 1056 80 896 80
WIRE 1792 80 1792 64
WIRE 1888 80 1888 64
WIRE 2304 96 2304 80
WIRE -400 112 -464 112
WIRE -288 112 -288 64
WIRE -288 112 -336 112
WIRE -176 112 -176 80
WIRE -16 112 -16 80
WIRE 96 112 96 64
WIRE 144 112 96 112
WIRE 272 112 208 112
WIRE 752 128 592 128
WIRE 896 128 752 128
WIRE 1024 128 896 128
WIRE 1136 128 1024 128
WIRE 1584 128 1584 80
WIRE 1632 128 1584 128
WIRE 1680 128 1680 96
WIRE 1680 128 1632 128
WIRE 1936 128 1936 64
WIRE 1968 128 1936 128
WIRE 2192 128 2128 128
WIRE 592 160 592 128
WIRE 752 160 752 128
WIRE 1792 160 1712 160
WIRE 1888 160 1888 144
WIRE 1888 160 1792 160
WIRE 1968 160 1888 160
WIRE 2160 160 2128 160
WIRE 896 192 896 128
WIRE 1472 192 1440 192
WIRE 1600 192 1552 192
WIRE 1680 192 1600 192
WIRE 1968 192 1680 192
WIRE 2304 192 2304 176
WIRE 2304 192 2128 192
WIRE 2432 192 2304 192
WIRE -464 208 -464 112
WIRE -416 208 -464 208
WIRE -288 208 -288 112
WIRE -288 208 -336 208
WIRE 96 208 96 112
WIRE 144 208 96 208
WIRE 272 208 272 112
WIRE 272 208 224 208
WIRE 1024 208 1024 128
WIRE 1680 208 1680 192
WIRE 2304 208 2304 192
WIRE -800 224 -800 176
WIRE 1824 224 1760 224
WIRE 1888 224 1824 224
WIRE 1968 224 1920 224
WIRE 2208 224 2128 224
WIRE -288 240 -288 208
WIRE -256 240 -288 240
WIRE 96 240 96 208
WIRE 96 240 64 240
WIRE 1600 240 1600 192
WIRE 1888 240 1888 224
WIRE -176 256 -176 192
WIRE -176 256 -192 256
WIRE -16 256 -16 192
WIRE 0 256 -16 256
WIRE 592 256 592 224
WIRE 752 256 752 224
WIRE 1136 256 1136 128
WIRE -256 272 -288 272
WIRE 96 272 64 272
WIRE 2208 272 2208 224
WIRE 1680 288 1680 272
WIRE 1760 288 1760 224
WIRE 2304 288 2304 272
WIRE -464 304 -464 208
WIRE 272 304 272 208
WIRE -800 336 -800 304
WIRE -288 336 -288 272
WIRE -96 336 -288 336
WIRE 96 336 96 272
WIRE 96 336 -96 336
WIRE 896 336 896 272
WIRE 1024 336 1024 272
WIRE 1888 336 1888 320
WIRE 1888 336 1824 336
WIRE 1920 336 1920 224
WIRE 1920 336 1888 336
WIRE 1888 352 1888 336
WIRE 2208 352 2208 336
WIRE -96 368 -96 336
WIRE 592 368 592 336
WIRE 752 368 752 336
WIRE 1600 384 1600 320
WIRE 1616 384 1600 384
WIRE 1760 384 1680 384
WIRE 1760 400 1760 384
WIRE 1888 432 1888 416
WIRE -464 480 -464 368
WIRE -96 480 -96 448
WIRE -96 480 -464 480
WIRE 272 480 272 368
WIRE 272 480 -96 480
WIRE 592 480 592 448
WIRE 752 480 752 448
WIRE 752 480 592 480
WIRE 896 480 896 400
WIRE 896 480 752 480
WIRE 1024 480 1024 416
WIRE 1024 480 896 480
WIRE 1136 480 1136 336
WIRE 1136 480 1024 480
WIRE 1760 496 1760 480
WIRE 2416 656 2416 624
WIRE 2416 656 2336 656
WIRE 2416 688 2416 656
WIRE 1920 704 1840 704
WIRE 2192 704 2112 704
WIRE 2336 704 2336 656
WIRE 2336 704 2272 704
WIRE 0 720 0 688
WIRE 0 720 -192 720
WIRE 1120 720 1120 704
WIRE 1120 720 928 720
WIRE -800 752 -800 720
WIRE 384 752 384 704
WIRE 0 768 0 720
WIRE 1120 768 1120 720
WIRE -192 784 -192 720
WIRE 928 784 928 720
WIRE 304 800 256 800
WIRE 512 800 464 800
WIRE 1712 800 1648 800
WIRE 1840 800 1792 800
WIRE 1920 800 1840 800
WIRE 2208 800 2112 800
WIRE 2288 800 2208 800
WIRE 2416 800 2416 768
WIRE 2416 800 2352 800
WIRE -64 816 -96 816
WIRE 1056 816 1024 816
WIRE 1840 832 1840 800
WIRE 2208 832 2208 800
WIRE 2208 832 2112 832
WIRE 2416 832 2416 800
WIRE 2416 832 2384 832
WIRE 304 848 256 848
WIRE 512 848 480 848
WIRE -800 880 -800 832
WIRE 2112 880 2112 832
WIRE 2128 880 2112 880
WIRE 2416 880 2416 832
WIRE 2384 896 2384 832
WIRE 2384 896 2352 896
WIRE -192 912 -192 864
WIRE -96 912 -96 816
WIRE -96 912 -192 912
WIRE 0 912 0 864
WIRE 96 912 0 912
WIRE 928 912 928 864
WIRE 1024 912 1024 816
WIRE 1024 912 928 912
WIRE 1120 912 1120 864
WIRE 1216 912 1120 912
WIRE 2128 912 2112 912
WIRE 384 928 384 896
WIRE 1840 944 1840 912
WIRE -464 960 -512 960
WIRE -192 960 -192 912
WIRE 0 960 0 912
WIRE 672 960 608 960
WIRE 928 960 928 912
WIRE 1120 960 1120 912
WIRE 2112 960 2112 912
WIRE 2208 960 2112 960
WIRE -352 1008 -400 1008
WIRE -256 1008 -272 1008
WIRE -96 1008 -96 912
WIRE -64 1008 -96 1008
WIRE 768 1008 736 1008
WIRE 864 1008 848 1008
WIRE 1024 1008 1024 912
WIRE 1056 1008 1024 1008
WIRE -464 1024 -512 1024
WIRE 672 1024 608 1024
WIRE 2208 1056 2208 960
WIRE 2416 1056 2416 1040
WIRE 2416 1056 2208 1056
WIRE -192 1120 -192 1056
WIRE 0 1120 0 1056
WIRE 0 1120 -192 1120
WIRE 928 1120 928 1056
WIRE 1120 1120 1120 1056
WIRE 1120 1120 928 1120
FLAG -800 16 0
FLAG -800 -128 Vd
FLAG 0 1120 0
FLAG 1120 1120 0
FLAG 96 912 VgA
FLAG 1216 912 VgB
FLAG 0 688 Vgg
FLAG 1120 704 Vgg
FLAG 256 848 Vcontrol
FLAG -512 960 Q
FLAG 608 960 _Q
FLAG 512 800 Q
FLAG 512 848 _Q
FLAG -512 1024 Vcontrol
FLAG 608 1024 Vcontrol
FLAG -176 80 VgA
FLAG -16 80 VgB
FLAG -96 -304 Vd
FLAG -96 480 0
FLAG 1056 80 0
FLAG 1024 480 0
FLAG -800 880 0
FLAG -800 720 Vcontrol
FLAG 384 928 0
FLAG 384 704 0
FLAG -800 336 0
FLAG -800 176 Vgg
FLAG 256 800 _Q
FLAG 2304 80 Vd
FLAG 1136 128 Vo3
FLAG 1760 496 0
FLAG 1888 432 0
FLAG 1680 288 0
FLAG 1824 224 Vref
FLAG 2208 224 Vref
FLAG 1440 192 Vsense
FLAG 2208 352 0
FLAG -96 336 Vsense
FLAG 1056 -256 Vo2
FLAG 2416 624 Vo2
FLAG 2304 288 0
FLAG 2416 1056 0
FLAG 1840 944 0
FLAG 1648 800 Vo_comp
FLAG 1840 704 Vref
FLAG 2160 160 Vcontrol
FLAG 1680 -144 0
FLAG 2432 192 Vgg
FLAG 2192 128 0
FLAG 1632 128 Vref
FLAG 1712 160 Vo_comp
FLAG 1216 128 Vgg
DATAFLAG 944 -256 "round($*100)/100"
DATAFLAG 944 128 "round($*100)/100"
SYMBOL voltage -800 -112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 30
SYMBOL npn -64 768 R0
SYMATTR InstName Q1A
SYMATTR Value 2N2222
SYMBOL npn 1056 768 R0
SYMATTR InstName Q1B
SYMATTR Value 2N2222
SYMBOL pnp -64 1056 M180
SYMATTR InstName Q2A
SYMATTR Value 2N2905A
SYMBOL pnp 1056 1056 M180
SYMATTR InstName Q2B
SYMATTR Value 2N2905A
SYMBOL res -208 768 R0
SYMATTR InstName RcA
SYMATTR Value 560
SYMBOL npn -256 960 R0
SYMATTR InstName QcA
SYMATTR Value BC547C
SYMBOL res -256 992 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RbA
SYMATTR Value 1k
SYMBOL Digital\\and -432 928 R0
SYMATTR InstName AA
SYMBOL Digital\\dflop 384 752 R0
SYMATTR InstName A1
SYMBOL res 912 768 R0
SYMATTR InstName RcB
SYMATTR Value 560
SYMBOL npn 864 960 R0
SYMATTR InstName QcB
SYMATTR Value BC547C
SYMBOL res 864 992 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RbB
SYMATTR Value 1k
SYMBOL Digital\\and 704 928 R0
SYMATTR InstName AB
SYMBOL res -192 208 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName RgA
SYMATTR Value 33
SYMBOL ind2 -304 -112 M180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L1A
SYMATTR Value 588.11µ
SYMATTR Type ind
SYMBOL res -304 -128 R0
SYMATTR InstName rL1A
SYMATTR Value 0.1
SYMBOL res 0 208 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName RgB
SYMATTR Value 33
SYMBOL ind2 80 -112 M180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L1B
SYMATTR Value 588.11µ
SYMATTR Type ind
SYMBOL res 80 -128 R0
SYMATTR InstName rL1B
SYMATTR Value 0.1
SYMBOL AutoGenerated\\irf540 -224 256 M0
SYMATTR InstName UA
SYMBOL AutoGenerated\\irf540 32 256 R0
SYMATTR InstName UB
SYMBOL cap 880 -48 R0
WINDOW 0 32 3 Left 2
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL res 1040 -128 R0
SYMATTR InstName RL2
SYMATTR Value 137
SYMBOL ind2 608 -144 M0
SYMATTR InstName L2A
SYMATTR Type ind
SYMATTR Value 47.05031m
SYMBOL cap 880 336 R0
WINDOW 0 32 3 Left 2
SYMATTR InstName C3
SYMATTR Value 1µ
SYMBOL ind2 608 240 M0
SYMATTR InstName L3A
SYMATTR Type ind
SYMATTR Value 1152.69µ
SYMBOL res 880 176 R0
SYMATTR InstName ESR1
SYMATTR Value 0.2
SYMBOL res 880 -208 R0
SYMATTR InstName ESR2
SYMATTR Value 0.2
SYMBOL res 1008 320 R0
SYMATTR InstName Rled1
SYMATTR Value 1k
SYMBOL res 576 -48 R0
SYMATTR InstName rL2A
SYMATTR Value 0.2
SYMBOL res 576 352 R0
SYMATTR InstName rL3A
SYMATTR Value 0.1
SYMBOL LED 1008 208 R0
SYMATTR InstName LED1
SYMBOL res 1120 240 R0
SYMATTR InstName RL3
SYMATTR Value 220
SYMBOL diode 608 -160 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2A
SYMATTR Value MUR460
SYMBOL diode 608 224 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3A
SYMATTR Value MUR110
SYMBOL ind2 768 -144 M0
SYMATTR InstName L2B
SYMATTR Type ind
SYMATTR Value 47.05031m
SYMBOL res 736 -48 R0
SYMATTR InstName rL2B
SYMATTR Value 0.2
SYMBOL diode 768 -160 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2B
SYMATTR Value MUR460
SYMBOL ind2 768 240 M0
SYMATTR InstName L3B
SYMATTR Type ind
SYMATTR Value 1152.69µ
SYMBOL res 736 352 R0
SYMATTR InstName rL3B
SYMATTR Value 0.1
SYMBOL voltage -800 736 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VA1
SYMATTR Value PULSE(0 1 0 0 0 3.3u 6.665u)
SYMBOL voltage -800 208 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 18
SYMBOL cap 1904 352 M0
SYMATTR InstName CT
SYMATTR Value 1.5n
SYMBOL cap 2192 272 R0
SYMATTR InstName Cref
SYMATTR Value 100n
SYMBOL res 2288 80 R0
SYMATTR InstName Rstart
SYMATTR Value 100k
SYMBOL res 1904 224 M0
SYMATTR InstName RT
SYMATTR Value 5.6k
SYMBOL npn 1824 288 M0
SYMATTR InstName Q1
SYMBOL res -112 352 R0
SYMATTR InstName Rsense
SYMATTR Value 0.1
SYMBOL cap 1616 368 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName Cramp
SYMATTR Value 10n
SYMBOL res 1616 224 M0
SYMATTR InstName Rramp
SYMATTR Value 330k
SYMBOL res 1456 176 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rcsf
SYMATTR Value 1k
SYMBOL cap 1664 208 R0
SYMATTR InstName Ccsf
SYMATTR Value 100p
SYMBOL res 1776 384 M0
SYMATTR InstName R210
SYMATTR Value 33k
SYMBOL cap 2288 208 R0
SYMATTR InstName Ccc
SYMATTR Value 100n
SYMBOL res 2400 672 R0
SYMATTR InstName Rfb2_b
SYMATTR Value 82k
SYMBOL res 2400 864 R0
SYMATTR InstName Rfb2_a
SYMATTR Value 1.8k
SYMBOL res 2400 944 R0
SYMATTR InstName Rfb2_a_var
SYMATTR Value 60
SYMBOL cap 2352 784 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName Cfb2
SYMATTR Value 100p
SYMBOL 4n35h 2016 752 M0
SYMATTR InstName X2
SYMBOL res 2288 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rled
SYMATTR Value 15k
SYMBOL res 1824 816 R0
SYMATTR InstName Ropto
SYMATTR Value 1k
SYMBOL res 1808 784 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rfbg
SYMATTR Value 4.7k
SYMBOL cap 1872 80 R0
SYMATTR InstName Cfb
SYMATTR Value 10n
SYMBOL res 1776 64 R0
SYMATTR InstName Rfb
SYMATTR Value 10k
SYMBOL res 1568 -16 R0
SYMATTR InstName Rss
SYMATTR Value 47k
SYMBOL diode 1664 32 R0
SYMATTR InstName Dss
SYMATTR Value 1N4148
SYMBOL pnp 1696 -64 R0
SYMATTR InstName Q2
SYMATTR Value BC557B
SYMBOL cap 1568 -112 R0
SYMATTR InstName Css
SYMATTR Value 10µ
SYMBOL tl431 2240 896 R180
SYMATTR InstName U1
SYMBOL AutoGenerated\\UCC28C45_STEADY 2048 176 R0
SYMATTR InstName U2
SYMBOL diode 768 224 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3B
SYMATTR Value MUR110
SYMBOL cap 256 304 R0
SYMATTR InstName CsnB
SYMATTR Value 680p
SYMBOL res 240 192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RsnB
SYMATTR Value 220
SYMBOL res -320 192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RsnA
SYMATTR Value 220
SYMBOL cap -480 304 R0
SYMATTR InstName CsnA
SYMATTR Value 680p
SYMBOL schottky 144 128 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName DsnB
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -336 96 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName DsnA
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL ind -304 -32 R0
SYMATTR InstName LdA
SYMATTR Value 29.4µ
SYMBOL ind 80 -32 R0
SYMATTR InstName LdB
SYMATTR Value 29.4µ
TEXT -1248 -312 Left 2 ;Directivas Spice
TEXT -1240 -112 Left 2 !.tran 0 20m 0 1u uic
TEXT -368 -280 Left 2 !KA L1A L2A L3A 1
TEXT -16 -280 Left 2 !KB L1B L2B L3B 1
RECTANGLE Normal 1264 576 -928 -352 2
RECTANGLE Normal -976 -48 -1280 -352 2
