Version 4
SHEET 1 4228 2080
WIRE -96 -256 -96 -304
WIRE -96 -256 -288 -256
WIRE 96 -256 -96 -256
WIRE 752 -256 592 -256
WIRE 896 -256 752 -256
WIRE 1056 -256 896 -256
WIRE 592 -224 592 -256
WIRE 752 -224 752 -256
WIRE -288 -208 -288 -256
WIRE 96 -208 96 -256
WIRE 2160 -208 2160 -240
WIRE 2160 -208 2112 -208
WIRE 896 -192 896 -256
WIRE 2160 -192 2160 -208
WIRE 1792 -144 1744 -144
WIRE 2048 -144 2016 -144
WIRE 2112 -144 2112 -208
WIRE 2112 -144 2048 -144
WIRE 2336 -144 2336 -176
WIRE 592 -128 592 -160
WIRE 752 -128 752 -160
WIRE -288 -112 -288 -128
WIRE 96 -112 96 -128
WIRE 1056 -112 1056 -256
WIRE 1696 -112 1600 -112
WIRE 1728 -112 1696 -112
WIRE 2160 -112 2160 -128
WIRE -848 -96 -848 -128
WIRE 1600 -96 1600 -112
WIRE 1696 -96 1696 -112
WIRE 1728 -80 1728 -112
WIRE 1760 -80 1728 -80
WIRE 1792 -80 1760 -80
WIRE 2048 -80 2016 -80
WIRE 2176 -80 2048 -80
WIRE 896 -48 896 -112
WIRE 592 -32 592 -48
WIRE 752 -32 752 -48
WIRE 1600 -16 1520 -16
WIRE 1696 -16 1696 -32
WIRE 1696 -16 1600 -16
WIRE 1760 -16 1696 -16
WIRE 1792 -16 1760 -16
WIRE 2048 -16 2016 -16
WIRE 2240 -16 2048 -16
WIRE 2336 -16 2336 -64
WIRE 2336 -16 2240 -16
WIRE 2416 -16 2336 -16
WIRE 2528 -16 2496 -16
WIRE 2240 0 2240 -16
WIRE -848 16 -848 -16
WIRE 2336 16 2336 -16
WIRE 1760 48 1728 48
WIRE 1792 48 1760 48
WIRE 2048 48 2016 48
WIRE 2080 48 2048 48
WIRE 592 80 592 48
WIRE 752 80 752 48
WIRE 752 80 592 80
WIRE 896 80 896 16
WIRE 896 80 752 80
WIRE 1056 80 1056 -32
WIRE 1056 80 896 80
WIRE 2240 96 2240 80
WIRE -176 112 -176 80
WIRE -16 112 -16 80
WIRE 2336 112 2336 80
WIRE 752 128 592 128
WIRE 896 128 752 128
WIRE 1024 128 896 128
WIRE 1136 128 1024 128
WIRE 592 160 592 128
WIRE 752 160 752 128
WIRE 1728 160 1728 48
WIRE 1856 160 1728 160
WIRE 2080 160 2080 48
WIRE 2080 160 1936 160
WIRE 2160 160 2080 160
WIRE -784 176 -848 176
WIRE 896 192 896 128
WIRE 1728 192 1728 160
WIRE 2080 192 2080 160
WIRE 2240 192 2240 160
WIRE 1024 208 1024 128
WIRE -848 224 -848 176
WIRE -288 240 -288 -32
WIRE -256 240 -288 240
WIRE 96 240 96 -32
WIRE 96 240 64 240
WIRE 2160 240 2160 160
WIRE 2176 240 2160 240
WIRE -176 256 -176 192
WIRE -176 256 -192 256
WIRE -16 256 -16 192
WIRE 0 256 -16 256
WIRE 592 256 592 224
WIRE 752 256 752 224
WIRE 1136 256 1136 128
WIRE -256 272 -288 272
WIRE 96 272 64 272
WIRE 1728 304 1728 256
WIRE 2080 304 2080 256
WIRE 2240 304 2240 288
WIRE 2352 304 2240 304
WIRE -848 336 -848 304
WIRE -288 336 -288 272
WIRE -96 336 -288 336
WIRE 96 336 96 272
WIRE 96 336 -96 336
WIRE 896 336 896 272
WIRE 1024 336 1024 272
WIRE -96 368 -96 336
WIRE 592 368 592 336
WIRE 752 368 752 336
WIRE -96 480 -96 448
WIRE 592 480 592 448
WIRE 752 480 752 448
WIRE 752 480 592 480
WIRE 896 480 896 400
WIRE 896 480 752 480
WIRE 1024 480 1024 416
WIRE 1024 480 896 480
WIRE 1136 480 1136 336
WIRE 1136 480 1024 480
WIRE 2480 672 2480 608
WIRE 2480 672 2160 672
WIRE -720 704 -800 704
WIRE 2480 704 2480 672
WIRE 0 720 0 688
WIRE 0 720 -192 720
WIRE 1152 720 1152 704
WIRE 1152 720 960 720
WIRE 1792 720 1712 720
WIRE 2032 720 1984 720
WIRE 2160 720 2160 672
WIRE 2160 720 2112 720
WIRE -800 752 -800 704
WIRE 0 768 0 720
WIRE 304 768 272 768
WIRE 512 768 496 768
WIRE 1152 768 1152 720
WIRE -192 784 -192 720
WIRE 960 784 960 720
WIRE 304 800 272 800
WIRE -64 816 -96 816
WIRE 1088 816 1056 816
WIRE 1584 816 1520 816
WIRE 1712 816 1664 816
WIRE 1792 816 1712 816
WIRE 2160 816 2160 800
WIRE 2160 816 1984 816
WIRE 2224 816 2160 816
WIRE 2352 816 2304 816
WIRE 2480 816 2480 784
WIRE 2480 816 2416 816
WIRE 512 832 496 832
WIRE 1712 848 1712 816
WIRE 2480 864 2480 816
WIRE 2480 864 2432 864
WIRE -800 880 -800 832
WIRE 2480 880 2480 864
WIRE 2160 896 2160 816
WIRE -192 912 -192 864
WIRE -96 912 -96 816
WIRE -96 912 -192 912
WIRE 0 912 0 864
WIRE 96 912 0 912
WIRE 960 912 960 864
WIRE 1056 912 1056 816
WIRE 1056 912 960 912
WIRE 1152 912 1152 864
WIRE 1248 912 1152 912
WIRE 400 944 400 912
WIRE 2432 944 2432 864
WIRE 2432 944 2208 944
WIRE -192 960 -192 912
WIRE 0 960 0 912
WIRE 960 960 960 912
WIRE 1152 960 1152 912
WIRE 1552 960 1552 928
WIRE 1712 960 1712 928
WIRE 2480 976 2480 960
WIRE 2480 976 2448 976
WIRE -496 992 -544 992
WIRE 656 992 624 992
WIRE -352 1008 -368 1008
WIRE -256 1008 -272 1008
WIRE -96 1008 -96 912
WIRE -64 1008 -96 1008
WIRE 800 1008 784 1008
WIRE 896 1008 880 1008
WIRE 1056 1008 1056 912
WIRE 1088 1008 1056 1008
WIRE -496 1024 -544 1024
WIRE 656 1024 624 1024
WIRE 2064 1072 2064 976
WIRE 2160 1072 2160 992
WIRE 2448 1072 2448 976
WIRE 2448 1072 2160 1072
WIRE 2480 1072 2480 1056
WIRE 2480 1072 2448 1072
WIRE -192 1120 -192 1056
WIRE 0 1120 0 1056
WIRE 0 1120 -192 1120
WIRE 960 1120 960 1056
WIRE 1152 1120 1152 1056
WIRE 1152 1120 960 1120
FLAG -848 16 0
FLAG -848 -128 Vd
FLAG 0 1120 0
FLAG 1152 1120 0
FLAG 96 912 VgA
FLAG 1248 912 VgB
FLAG 0 688 Vgg
FLAG 1152 704 Vgg
FLAG -176 80 VgA
FLAG -16 80 VgB
FLAG -96 -304 Vd
FLAG -96 480 0
FLAG 1056 80 0
FLAG 1024 480 0
FLAG -800 880 0
FLAG -656 736 Vcontrol
FLAG -848 336 0
FLAG -784 176 Vgg
FLAG 1136 128 Vo3
FLAG -96 336 Vsense
FLAG 1056 -256 Vo2
FLAG -720 256 Vo3
FLAG 1760 -80 Err
FLAG 1760 -16 Vfb
FLAG 1760 48 Vref
FLAG 2048 -144 Vcc
FLAG 2048 -80 Out
FLAG 2048 -16 Ifb
FLAG 2048 48 Osc
FLAG 1728 304 0
FLAG 2080 304 0
FLAG 2336 112 0
FLAG 1744 -144 0
FLAG 2176 -80 Vcontrol
FLAG 2528 -16 Vsense
FLAG 2160 -112 0
FLAG 2160 -240 Vgg
FLAG 1520 -16 Vo_comp
FLAG 2352 304 Vref
FLAG 2336 -176 Vref
FLAG 272 800 Vcontrol
FLAG 512 768 Q
FLAG 512 832 _Q
FLAG 400 944 0
FLAG 400 688 0
FLAG 272 768 _Q
FLAG 624 992 _Q
FLAG 624 1024 Vcontrol
FLAG -544 992 Q
FLAG -544 1024 Vcontrol
FLAG 736 848 0
FLAG 736 768 VDD
FLAG 2480 608 Vo2
FLAG 2480 1072 0
FLAG 1712 960 0
FLAG 1520 816 Vo_comp
FLAG 1712 720 Vref
FLAG 2064 1072 0
FLAG 2928 816 0
FLAG 2928 736 Vfeed
FLAG 2384 576 Vfeed
FLAG 1552 960 0
DATAFLAG 944 -256 "round($*100)/100"
DATAFLAG 944 128 "round($*100)/100"
SYMBOL voltage -848 -112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 30
SYMBOL npn -64 768 R0
SYMATTR InstName Q1A
SYMATTR Value 2N2222
SYMBOL npn 1088 768 R0
SYMATTR InstName Q1B
SYMATTR Value 2N2222
SYMBOL pnp -64 1056 M180
SYMATTR InstName Q2A
SYMATTR Value 2N2905A
SYMBOL pnp 1088 1056 M180
SYMATTR InstName Q2B
SYMATTR Value 2N2905A
SYMBOL res -208 768 R0
SYMATTR InstName RcA
SYMATTR Value 560
SYMBOL npn -256 960 R0
SYMATTR InstName QcA
SYMATTR Value BC547C
SYMBOL res -256 992 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RbA
SYMATTR Value 1k
SYMBOL res 944 768 R0
SYMATTR InstName RcB
SYMATTR Value 560
SYMBOL npn 896 960 R0
SYMATTR InstName QcB
SYMATTR Value BC547C
SYMBOL res 896 992 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RbB
SYMATTR Value 1k
SYMBOL res -192 208 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName RgA
SYMATTR Value 33
SYMBOL ind2 -304 -112 M180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L1A
SYMATTR Value 476µ
SYMATTR Type ind
SYMBOL res -304 -128 R0
SYMATTR InstName rL1A
SYMATTR Value 0.1
SYMBOL res 0 208 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName RgB
SYMATTR Value 33
SYMBOL ind2 80 -112 M180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L1B
SYMATTR Value 476µ
SYMATTR Type ind
SYMBOL res 80 -128 R0
SYMATTR InstName rL1B
SYMATTR Value 0.1
SYMBOL AutoGenerated\\irf540 -224 256 M0
SYMATTR InstName UA
SYMBOL AutoGenerated\\irf540 32 256 R0
SYMATTR InstName UB
SYMBOL cap 880 -48 R0
WINDOW 0 32 3 Left 2
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL res 1040 -128 R0
SYMATTR InstName RL2
SYMATTR Value 137
SYMBOL ind2 608 -144 M0
SYMATTR InstName L2A
SYMATTR Type ind
SYMATTR Value 38.1m
SYMBOL cap 880 336 R0
WINDOW 0 32 3 Left 2
SYMATTR InstName C3
SYMATTR Value 1µ
SYMBOL ind2 608 240 M0
SYMATTR InstName L3A
SYMATTR Type ind
SYMATTR Value 933µ
SYMBOL res 880 176 R0
SYMATTR InstName ESR3
SYMATTR Value 0.2
SYMBOL res 880 -208 R0
SYMATTR InstName ESR2
SYMATTR Value 0.2
SYMBOL res 1008 320 R0
SYMATTR InstName Rled
SYMATTR Value 1k
SYMBOL res 576 -48 R0
SYMATTR InstName rL2A
SYMATTR Value 2
SYMBOL res 576 352 R0
SYMATTR InstName rL3A
SYMATTR Value 0.1
SYMBOL LED 1008 208 R0
SYMATTR InstName LED
SYMBOL res 1120 240 R0
SYMATTR InstName RL3
SYMATTR Value 220
SYMBOL diode 608 -160 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2A
SYMATTR Value MUR460
SYMBOL diode 608 224 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3A
SYMATTR Value MUR110
SYMBOL ind2 768 -144 M0
SYMATTR InstName L2B
SYMATTR Type ind
SYMATTR Value 38.1m
SYMBOL res 736 -48 R0
SYMATTR InstName rL2B
SYMATTR Value 2
SYMBOL diode 768 -160 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2B
SYMATTR Value MUR460
SYMBOL ind2 768 240 M0
SYMATTR InstName L3B
SYMATTR Type ind
SYMATTR Value 933µ
SYMBOL res 736 352 R0
SYMATTR InstName rL3B
SYMATTR Value 0.1
SYMBOL voltage -800 736 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VA1
SYMATTR Value PULSE(0 18 0 0 0 3.7u 6.665u)
SYMBOL voltage -848 208 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(0 18 0 0 0 10 10)
SYMBOL res -112 352 R0
SYMATTR InstName Rsense
SYMATTR Value 0.1
SYMBOL diode 768 224 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3B
SYMATTR Value MUR110
SYMBOL cap 2064 192 R0
SYMATTR InstName CT
SYMATTR Value 1.5n
SYMBOL cap 1712 192 R0
SYMATTR InstName Cref
SYMATTR Value 100n
SYMBOL res 1952 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RT
SYMATTR Value 6.85k
SYMBOL cap 2144 -192 R0
SYMATTR InstName Cgg
SYMATTR Value 100n
SYMBOL res 2512 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rcsf
SYMATTR Value 1k
SYMBOL cap 2320 16 R0
SYMATTR InstName Ccfs
SYMATTR Value 100p
SYMBOL cap 1712 -32 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName Cfb
SYMATTR Value 17n
SYMBOL res 1616 0 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rfb
SYMATTR Value 10k
SYMBOL npn 2176 288 M180
SYMATTR InstName Q1
SYMBOL cap 2256 96 M0
SYMATTR InstName Cramp
SYMATTR Value 1n
SYMBOL res 2256 -16 M0
SYMATTR InstName Rramp
SYMATTR Value 100k
SYMBOL res 2320 -160 R0
SYMATTR InstName Rp
SYMATTR Value 12k
SYMBOL UC3843A 1904 -48 R0
SYMATTR InstName X1
SYMBOL CD4013B 400 688 R0
WINDOW 39 16 236 Left 0
SYMATTR SpiceLine VDD={VDD}  SPEED=1.0  TRIPDT=5e-9
SYMATTR InstName U1
SYMBOL CD4011B 720 944 R0
WINDOW 39 -32 141 Left 0
SYMATTR SpiceLine VDD={VDD}  SPEED=1.0  TRIPDT=5e-9
SYMATTR InstName U2
SYMBOL CD4011B -432 944 R0
WINDOW 39 -32 141 Left 0
SYMATTR SpiceLine VDD={VDD}  SPEED=1.0  TRIPDT=5e-9
SYMATTR InstName U3
SYMBOL voltage 736 752 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 18
SYMBOL res 2464 688 R0
SYMATTR InstName Rfb_b1
SYMATTR Value 110k
SYMBOL res 2464 864 R0
SYMATTR InstName Rfb_a1
SYMATTR Value 2.5k
SYMBOL res 2464 960 R0
SYMATTR InstName Rfb_a_var1
SYMATTR Value 5
SYMBOL cap 2416 800 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName CcompZ1
SYMATTR Value 10n
SYMBOL 4n35h 1888 768 M0
SYMATTR InstName X2
SYMBOL res 2128 704 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rled_opto1
SYMATTR Value 47k
SYMBOL res 1696 832 R0
SYMATTR InstName Ropto1
SYMATTR Value 1k
SYMBOL res 1680 800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rfbg1
SYMATTR Value 2.2k
SYMBOL tl431 2160 944 M0
SYMATTR InstName U4
SYMBOL zener 2080 976 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value UDZV10B
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 2144 704 R0
SYMATTR InstName RTLbias1
SYMATTR Value 50k
SYMBOL voltage 2928 720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value PULSE(110 115 0 3.33u 3.33u 0 6.66u)
SYMBOL res 1536 832 R0
SYMATTR InstName Ropto2
SYMATTR Value 2k
SYMBOL res 2320 800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 680k
TEXT -1248 -312 Left 2 ;Directivas Spice
TEXT -1248 -120 Left 2 !.tran 0 100m 0 1u uic
TEXT -368 -280 Left 2 !KA L1A L2A L3A 1
TEXT -16 -280 Left 2 !KB L1B L2B L3B 1
TEXT -1248 -256 Left 2 !.param VDD=18V
TEXT -1248 -184 Left 2 !.lib CD4000.lib
TEXT 2336 992 Left 2 ;Preset\n100 Ohm
RECTANGLE Normal 1264 576 -928 -352 2
RECTANGLE Normal -976 -48 -1280 -352 2
